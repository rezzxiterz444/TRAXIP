<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>REZZ X FILE TRACKER</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root { 
    --primary-color: #8a2be2; 
    --dark-bg: #121212; 
    --text-color: #fff; 
    --accent-glow: 0 0 10px rgba(138,43,226,0.7);
    --glow-intense: 0 0 15px rgba(138,43,226,0.9);
}
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}
body{
    background-color:var(--dark-bg);
    color:var(--text-color);
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    padding:20px;
    font-family: 'Rajdhani', sans-serif;
    text-transform: uppercase;
}
.container{
    max-width:1000px;
    width:100%;
    text-align:center;
}
header{
    margin-bottom:20px;
    padding:20px;
    border-bottom:2px solid var(--primary-color);
    box-shadow: var(--glow-intense);
    border-radius: 10px;
}
h1{
    font-size:2.5rem;
    text-shadow: var(--accent-glow);
    color:var(--primary-color);
    font-family: 'Orbitron', sans-serif;
    font-weight: 900;
    letter-spacing: 3px;
    margin-bottom: 10px;
}
.subtitle{
    opacity:0.9;
    letter-spacing:3px;
    font-weight: 600;
    font-size: 1.2rem;
    text-shadow: 0 0 5px rgba(255,255,255,0.5);
}
.input-section, .results-section{
    background-color:#0a0a0a;
    padding:20px;
    border-radius:10px;
    margin-bottom:20px;
    border:1px solid rgba(138,43,226,0.3);
    box-shadow: var(--accent-glow);
}
.ip-input{
    width:100%;
    padding:12px;
    margin-bottom:10px;
    border-radius:5px;
    border:2px solid var(--primary-color);
    background-color: rgba(255,255,255,0.05);
    color:white;
    text-align:center;
    font-size: 1.1rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 0 5px rgba(138,43,226,0.5);
    transition: all 0.3s;
}
.ip-input:focus {
    outline: none;
    box-shadow: 0 0 10px rgba(138,43,226,0.8);
}
.track-btn, .reset-btn, .export-btn{
    padding:12px 20px;
    border:none;
    border-radius:5px;
    cursor:pointer;
    margin:5px;
    font-weight:bold;
    text-transform:uppercase;
    background-color: var(--primary-color);
    color:white;
    font-size: 1rem;
    letter-spacing: 1px;
    box-shadow: 0 0 5px rgba(138,43,226,0.5);
    transition: all 0.3s;
}
.track-btn:hover, .reset-btn:hover, .export-btn:hover{
    background-color:#6a1cb3;
    transform: translateY(-2px);
    box-shadow: 0 0 15px rgba(138,43,226,0.8);
}
.error-message{
    color:#ff6b6b;
    margin-top:5px;
    font-weight:bold;
    text-shadow: 0 0 5px rgba(255,107,107,0.5);
    letter-spacing: 1px;
}
.info-grid{
    display:grid;
    grid-template-columns: repeat(auto-fill,minmax(300px,1fr));
    gap:15px;
    text-align:left;
    margin-bottom:15px;
}
.info-item{
    padding:15px;
    border-left:3px solid var(--primary-color);
    background: rgba(138,43,226,0.05);
    border-radius: 5px;
    box-shadow: 0 0 5px rgba(138,43,226,0.3);
    transition: all 0.3s;
}
.info-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 0 10px rgba(138,43,226,0.5);
}
.info-label{
    font-weight:bold;
    font-size:0.9rem;
    color: var(--primary-color);
    text-shadow: 0 0 5px rgba(138,43,226,0.5);
    letter-spacing: 1px;
    margin-bottom: 5px;
}
.info-value{
    font-size:1.1rem;
    word-break: break-all;
    text-shadow: 0 0 3px rgba(255,255,255,0.3);
    font-weight: 500;
}
#map{
    height:400px;
    border-radius:10px;
    margin-top:15px;
    box-shadow: 0 0 10px rgba(138,43,226,0.3);
    border: 1px solid rgba(138,43,226,0.2);
}
.toast{
    position:fixed;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    background:var(--primary-color);
    padding:10px 20px;
    border-radius:5px;
    opacity:0;
    color:white;
    transition:0.5s;
    text-transform: uppercase;
    font-weight: bold;
    letter-spacing: 1px;
    box-shadow: var(--glow-intense);
    z-index: 1000;
}
.toast.show{
    opacity:1;
}
.loading{
    display:none;
    margin:15px 0;
}
.spinner{
    border:4px solid rgba(255,255,255,0.3);
    border-top:4px solid var(--primary-color);
    border-radius:50%;
    width:35px;
    height:35px;
    animation:spin 1s linear infinite;
    margin:0 auto;
    box-shadow: 0 0 10px rgba(138,43,226,0.5);
}
.loading p {
    margin-top: 10px;
    text-shadow: 0 0 5px rgba(255,255,255,0.5);
    letter-spacing: 1px;
    font-weight: 600;
}
@keyframes spin{
    0%{transform:rotate(0deg);}
    100%{transform:rotate(360deg);}
}
@media(max-width:600px){
    .info-grid{grid-template-columns:1fr;}
    h1 { font-size: 1.8rem; }
}
</style>
</head>
<body>
<div class="container">
<header>
<h1>REZZ X FILE</h1>
<div class="subtitle">IP TRAKER DEVELOPER @REZZXITERZ</div>
</header>

<section class="input-section">
<input type="text" placeholder="MASUKAN IP TARGET" id="ipInput" class="ip-input">
<button class="track-btn" id="trackBtn">LACAK IP</button>
<button class="reset-btn" id="resetBtn">RESET</button>
<button class="export-btn" id="exportBtn">EXPORT HISTORY</button>
<div class="loading" id="loading"><div class="spinner"></div><p>SEDANG MENCARI INFORMASI...</p></div>
<div class="error-message" id="errorMessage"></div>
</section>

<section class="results-section" id="resultsSection" style="display:none;">
<h2>INFORMASI IP TARGET</h2>
<div class="info-grid" id="infoGrid"></div>
<div id="map"></div>
</section>
</div>

<div class="toast" id="toast">PESAN</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const trackBtn = document.getElementById('trackBtn');
const resetBtn = document.getElementById('resetBtn');
const exportBtn = document.getElementById('exportBtn');
const ipInput = document.getElementById('ipInput');
const errorMessage = document.getElementById('errorMessage');
const loading = document.getElementById('loading');
const resultsSection = document.getElementById('resultsSection');
const infoGrid = document.getElementById('infoGrid');
const toast = document.getElementById('toast');
let map, marker;

function showToast(message){
    toast.textContent=message;
    toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'),2500);
}

function isValidIP(ip){
    const parts=ip.split(".");
    if(parts.length!==4) return false;
    return parts.every(n=>{
        let x=Number(n);
        return x>=0 && x<=255;
    });
}

function saveHistory(data){
    let history=JSON.parse(localStorage.getItem('ipHistory')||'[]');
    history.unshift({...data,time:new Date().toLocaleString()});
    if(history.length>20) history=history.slice(0,20);
    localStorage.setItem('ipHistory',JSON.stringify(history));
}

function exportHistory(){
    let history=JSON.parse(localStorage.getItem('ipHistory')||'[]');
    if(history.length===0){
        showToast('TIDAK ADA HISTORY');
        return;
    }
    let csv='IP,CITY,REGION,COUNTRY,ASN,ISP,TIME\n';
    history.forEach(h=>{
        csv+=`${h.ip},${h.city},${h.region},${h.country_name},${h.asn},${h.org},${h.time}\n`;
    });
    let blob=new Blob([csv],{type:'text/csv'});
    let url=URL.createObjectURL(blob);
    let a=document.createElement('a');
    a.href=url;
    a.download='ip_history.csv';
    a.click();
    URL.revokeObjectURL(url);
    showToast('HISTORY DIEXPORT');
}

function displayResults(data){
    infoGrid.innerHTML = `
    <div class="info-item"><div class="info-label">IP ADDRESS</div><div class="info-value">${data.ip||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">KOTA</div><div class="info-value">${data.city||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">WILAYAH</div><div class="info-value">${data.region||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">NEGARA</div><div class="info-value">${data.country_name||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">PROVIDER / ISP</div><div class="info-value">${data.org||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">ASN</div><div class="info-value">${data.asn||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">HOSTNAME</div><div class="info-value">${data.hostname||'TIDAK TERSEDIA'}</div></div>
    <div class="info-item"><div class="info-label">VPN/PROXY</div><div class="info-value">${data.proxy?'YA':'TIDAK'}</div></div>
    <div class="info-item"><div class="info-label">KOORDINAT</div><div class="info-value">${data.latitude||'TIDAK TERSEDIA'}, ${data.longitude||'TIDAK TERSEDIA'}</div></div>
    `;

    resultsSection.style.display='block';
    
    if(data.latitude && data.longitude){
        if(map){map.remove();}
        map=L.map('map').setView([data.latitude,data.longitude],13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'Â© OpenStreetMap'}).addTo(map);
        marker=L.marker([data.latitude,data.longitude]).addTo(map).bindPopup(`IP: ${data.ip}`).openPopup();
    } else {
        document.getElementById('map').innerHTML='<p>KOORDINAT TIDAK TERSEDIA.</p>';
    }

    saveHistory(data);
}

// FUNGSI AMBIL DATA DARI API
async function fetchIP(ip){
    loading.style.display='block';
    trackBtn.disabled=true;
    errorMessage.textContent='';
    resultsSection.style.display='none';
    
    try{
        let geo=await fetch(`https://ipapi.co/${ip}/json/`).then(res=>res.json());
        // CONTOH PROXY DETECTION SEDERHANA (IPAPI GRATIS TIDAK MEMBERIKAN PROXY INFO, INI PLACEHOLDER)
        geo.proxy=false; // BISA INTEGRASI API LAIN UNTUK CEK PROXY/VPN
        loading.style.display='none';
        trackBtn.disabled=false;
        if(geo.error){errorMessage.textContent='IP TIDAK DITEMUKAN!';return;}
        displayResults(geo);
        showToast('IP BERHASIL DILACAK!');
    }catch(err){
        loading.style.display='none';
        trackBtn.disabled=false;
        errorMessage.textContent='TERJADI KESALAHAN SAAT MENGAMBIL DATA!';
        console.error(err);
    }
}

trackBtn.addEventListener('click',()=>{
    const ip=ipInput.value.trim();
    if(!ip){errorMessage.textContent='MASUKAN IP TARGET!';return;}
    if(!isValidIP(ip)){errorMessage.textContent='FORMAT IP TIDAK VALID!';return;}
    fetchIP(ip);
});

resetBtn.addEventListener('click',()=>{
    ipInput.value='';
    resultsSection.style.display='none';
    errorMessage.textContent='';
    showToast('FORM DIRESET!');
});

exportBtn.addEventListener('click',exportHistory);

ipInput.addEventListener('keypress',e=>{
    if(e.key==='Enter') trackBtn.click();
});
</script>
</body>
</html>